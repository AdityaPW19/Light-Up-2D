# LightUp2D - Weekly Project Update

**Date: October 10, 2025**

### Hello Team,

This week focused on intelligent camera behavior, interaction feel, stability, and preparing for richer systemic gameplay. We evolved last week’s visual polish into gameplay-aware responsiveness, improved internal architecture for scalability, and began implementing the companion system.

---

### Key Accomplishments:

1.  **Smart Dynamic Camera System**
    *   Added global `CameraController` singleton with pair focus logic (player + target).
    *   Automatic proximity-based activation near mirrors; no longer tied to drag events.
    *   Smooth zoom framing with padding, player margin protection, and graceful reset.
    *   Separate lerp speeds for position, zoom, and reset for feel tuning.
    *   Corrected world/viewport math (`zoom < 1` = wider view) to eliminate jumpy behavior.
    *   Performance tweaks: frame-skipped proximity checks and cached target lookups.

2.  **Mirror Interaction Refactor**
    *   Replaced input-event-triggered camera logic with continuous range detection.
    *   Added camera activation/deactivation state management (enter/exit zone).
    *   Rotation precision mode preserved; now more intuitive since framing happens earlier.
    *   Reduced redundant visibility checks and logging noise.

3.  **Target Detection & Scene Robustness**
    *   Implemented `LightTarget` discovery via group membership (`light_target`).
    *   Added fallback hierarchy search and caching to minimize tree scans.
    *   Prevented misidentification of mirror itself as target.
    *   Added group registration in `LightTarget` script.

4.  **Performance & Stability Improvements**
    *   Introduced `cached_target` in mirrors to avoid repeated lookups.
    *   Reduced per-frame processing: proximity checks run every 5 frames.
    *   Cleaned up parser/indentation and stray conditional body edge case.
    *   Removed unnecessary synchronous camera jumps; all transitions now interpolated.

5.  **Code Quality & Debug Enhancements**
    *   Expanded structured debug logging (activation, target resolution, zoom states).
    *   Separated configuration parameters (`lerp_speed`, `zoom_lerp_speed`, `reset_lerp_speed`).
    *   Safer early returns when camera/player/target references become invalid.

6.  **Companion System Foundation**
    *   Added basic companion movement / follow prototype (initial behavior loop).
    *   Established groundwork for future roles: hint delivery, narrative, light-based reactions.

7.  **UX / Feel Adjustments**
    *   Camera recenters smoothly after leaving mirror zones (fixed earlier “off-center” reset).
    *   Reduced zoom “lag” by separating zoom vs position interpolation speeds.
    *   Added parameter hooks for future hysteresis (entry vs exit distances).

8.  **Technical Debt Reduction**
    *   Removed obsolete code paths for mirror drag-triggered zoom.
    *   Normalized naming and state flags (`camera_focus_active`, `was_in_range_last_frame`).
    *   Structured future extension points (door transitions, companion dialogue, effects).

---

### Current Project Status:

Core interaction systems (player, mirrors, light target framing) are now responsive and production-aligned. Visual polish from last week (burn transition, refined rotation) is reinforced by systemic camera intelligence. Companion groundwork opens narrative / assistive design paths. The game is transitioning from “mechanics assembled” to “play experience shaping.”

#### Changelog Snapshot (Technical):
- **Added:** `scripts/autoload/CameraController.gd` (dynamic framing + reset)
- **Modified:** `Mirror.gd` (proximity logic, caching, activation flow)
- **Added:** `LightTarget` group tagging and discovery logic
- **Fixed:** Zoom math, viewport bounds calculations, parser indentation issue
- **Added:** Companion follow prototype (initial pathing/movement loop—baseline only)

---

### Next Steps (Planned for Upcoming Week):

#### Core Gameplay & Progression
- Implement door/opening animation & trigger on target activation
- Add level progression manager (sequence loading + transition integration)
- Finalize collision setup for all interactable/environment objects

#### Companion & Interaction
- Expand companion follow smoothing + obstacle avoidance
- (Optional) Introduce early “context ping” when player lingers near mirrors

#### Audio & FX
- Integrate baseline SFX set (rotation tick, zoom whoosh, target success)
- Add ambient loop + fade control tied to state transitions
- Hook burn transition to layered audio cue

#### UI / Presentation
- Begin building Main Menu, Pause Menu, HUD shell
- Add minimal debug overlay toggle (FPS, state, camera mode)
- Light beam visualization pass (if shader prep ready)

#### Camera & Feel Enhancements
- Add hysteresis for proximity activation (e.g., enter at 140, exit at 165) to prevent flicker
- Optional “soft framing” mode where zoom only adjusts if outside tolerance band
- Parameter balancing for lerp speeds across device performance tiers

#### Content & Environment
- Start assembling first puzzle sequence with varied mirror layouts
- Begin atmospheric layer: subtle screen vignette / glow pulses during targeting

#### Polish / Systems
- Introduce `SaveManager` scaffolding (settings + progression)
- Implement configurable difficulty/light assistance toggles
- Add test harness scene for rapid mirror–camera iterations

---

### Low Priority (Deferred Until Core Loop Stable):

- Companion contextual comments (educational / narrative)
- Physics-of-light educational overlays
- Companion “light resilience” / survival bar mechanic
- Advanced accessibility modes (color shift, motion comfort options)

---

### Risks / Watchlist:

- Potential camera edge jitter if player + target extreme diagonal separation (monitor)
- Need hysteresis soon to avoid “border snapping” in tight mirror clusters
- `LightTarget` group reliance requires discipline (must ensure every target joins group)

---

### Tuning Opportunities:

- Adjust `zoom_lerp_speed` (currently 4.0) if players report slow responsiveness
- Evaluate `padding` vs puzzle density; may expose too much space in compact levels
- Consider enabling easing curves (Tween-based) for camera transitions if needed

---

### Recommended Immediate Micro-Tasks (Quick Wins):

- Add hysteresis constants: `ENTER_DISTANCE`, `EXIT_DISTANCE`
- Add debug toggle key (e.g., F3) to show camera/zoom metrics
- Expose `CameraController` parameters in a global balancing panel

---

### Outstanding Questions (If Needed for Next Sprint Planning):

- Do we want the companion to interact with beam logic (block/reflect) or remain non-physical?
- Should burn transition timing synchronize with door open sequence or remain independent?
- Will we integrate narrative beats before or after first full puzzle chain?

Excellent momentum—systems now feel cohesive, and we have a strong base to layer in progression, atmosphere, and narrative.

**@Dhiraj Singh @Shikhar @Aditya Sharma**
